{"ast":null,"code":"import Stomp from 'webstomp-client';\nimport SockJS from 'sockjs-client';\nexport default {\n  name: 'ChatRoom',\n\n  data() {\n    return {\n      userName: sessionStorage.getItem('user_name'),\n      message: \"\",\n      recvList: [],\n      textData: \"\"\n    };\n  },\n\n  created() {\n    this.connect();\n  },\n\n  props: {\n    keyvalue: String\n  },\n  methods: {\n    sendMessage(e) {\n      if (e.keyCode === 13 && this.userName !== '' && this.message !== '') {\n        this.send();\n        this.message = '';\n      }\n    },\n\n    send() {\n      console.log(\"Send message:\" + this.message);\n\n      if (this.stompClient && this.stompClient.connected) {\n        const msg = {\n          userName: this.userName,\n          content: this.message\n        };\n        this.stompClient.send(\"/chat_receive/\" + this.keyvalue, JSON.stringify(msg), {});\n      }\n    },\n\n    connect() {\n      const serverURL = \"http://localhost:8085\";\n      let socket = new SockJS(serverURL);\n      this.stompClient = Stomp.over(socket);\n      console.log(`소켓 연결 시도. 서버 주소: ${serverURL}`);\n      this.stompClient.connect({}, frame => {\n        // 소켓 연결 성공\n        this.connected = true;\n        console.log('소켓 연결 성공', frame);\n        this.stompClient.subscribe(\"/chat_send/\" + this.keyvalue, res => {\n          console.log('메시지 내용.', res.body);\n          this.recvList.push(JSON.parse(res.body));\n        });\n      }, error => {\n        // 소켓 연결 실패\n        console.log('소켓 연결 실패', error);\n        this.connected = false;\n      });\n    } // fnRun() {\n    //   let objWSH = new ActiveXObject(\"WScript.Shell\");\n    //   objWSH.Run(\"C:/javaram_chat/result.txt\");\n    // }\n\n\n  }\n};","map":{"version":3,"mappings":"AAwDA,OAAOA,KAAP,MAAkB,iBAAlB;AACA,OAAOC,MAAP,MAAmB,eAAnB;AAEA,eAAe;AACbC,MAAI,EAAE,UADO;;AAEbC,MAAI,GAAG;AACL,WAAO;AACLC,cAAQ,EAAEC,cAAc,CAACC,OAAf,CAAuB,WAAvB,CADL;AAELC,aAAO,EAAE,EAFJ;AAGLC,cAAQ,EAAE,EAHL;AAILC,cAAQ,EAAE;AAJL,KAAP;AAMD,GATY;;AAUbC,SAAO,GAAG;AACR,SAAKC,OAAL;AACD,GAZY;;AAcbC,OAAK,EAAE;AACLC,YAAQ,EAAEC;AADL,GAdM;AAkBbC,SAAO,EAAE;AACPC,eAAU,CAAGC,CAAH,EAAM;AACd,UAAGA,CAAC,CAACC,OAAF,KAAc,EAAd,IAAoB,KAAKd,QAAL,KAAkB,EAAtC,IAA4C,KAAKG,OAAL,KAAiB,EAAhE,EAAmE;AACjE,aAAKY,IAAL;AACA,aAAKZ,OAAL,GAAe,EAAf;AAEF;AACD,KAPM;;AAQPY,QAAI,GAAG;AACLC,aAAO,CAACC,GAAR,CAAY,kBAAkB,KAAKd,OAAnC;;AACA,UAAI,KAAKe,WAAL,IAAoB,KAAKA,WAAL,CAAiBC,SAAzC,EAAoD;AAClD,cAAMC,GAAE,GAAI;AACVpB,kBAAQ,EAAE,KAAKA,QADL;AAEVqB,iBAAO,EAAE,KAAKlB;AAFJ,SAAZ;AAIA,aAAKe,WAAL,CAAiBH,IAAjB,CAAsB,mBAAiB,KAAKN,QAA5C,EAAsDa,IAAI,CAACC,SAAL,CAAeH,GAAf,CAAtD,EAA2E,EAA3E;AACF;AACD,KAjBM;;AAkBPb,WAAO,GAAG;AACR,YAAMiB,SAAQ,GAAI,uBAAlB;AACA,UAAIC,MAAK,GAAI,IAAI5B,MAAJ,CAAW2B,SAAX,CAAb;AACA,WAAKN,WAAL,GAAmBtB,KAAK,CAAC8B,IAAN,CAAWD,MAAX,CAAnB;AACAT,aAAO,CAACC,GAAR,CAAa,oBAAmBO,SAAU,EAA1C;AACA,WAAKN,WAAL,CAAiBX,OAAjB,CACE,EADF,EAEEoB,KAAI,IAAK;AACP;AACA,aAAKR,SAAL,GAAiB,IAAjB;AACAH,eAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBU,KAAxB;AAEA,aAAKT,WAAL,CAAiBU,SAAjB,CAA2B,gBAAc,KAAKnB,QAA9C,EAAwDoB,GAAE,IAAK;AAC7Db,iBAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBY,GAAG,CAACC,IAA3B;AACA,eAAK1B,QAAL,CAAc2B,IAAd,CAAmBT,IAAI,CAACU,KAAL,CAAWH,GAAG,CAACC,IAAf,CAAnB;AACD,SAHD;AAID,OAXH,EAYEG,KAAI,IAAK;AACP;AACAjB,eAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBgB,KAAxB;AACA,aAAKd,SAAL,GAAiB,KAAjB;AACF,OAhBF;AAkBD,KAzCM,CA2CP;AACA;AACA;AACA;;;AA9CO;AAlBI,CAAf","names":["Stomp","SockJS","name","data","userName","sessionStorage","getItem","message","recvList","textData","created","connect","props","keyvalue","String","methods","sendMessage","e","keyCode","send","console","log","stompClient","connected","msg","content","JSON","stringify","serverURL","socket","over","frame","subscribe","res","body","push","parse","error"],"sourceRoot":"","sources":["C:\\eclipse_portable\\WORKSPACE\\javaram\\vue\\src\\components\\conference\\page\\ChatRoom2.vue"],"sourcesContent":["<template>\r\n\r\n<div id=\"container\">\r\n\r\n  <div id = \"mail_tab\">\r\n    <h3 id = \"mail_title\">Web Chat</h3>\r\n      <!-- txt 파일 저장하기 버튼 -->\r\n    <button type=\"button\" class=\"btn btn-outline-success\" onclick=\"alert('대화 내용 저장 완료')\">저장하기</button>\r\n  </div>\r\n\r\n  <hr>\r\n\r\n  <table>\r\n\r\n    <div>\r\n      <!-- 채팅방 -->\r\n      <td class=\"table_chat\">\r\n        \r\n        <div class=\"main_right\">\r\n          <div class=\"chat_right\">\r\n            <!-- 아이디 확인(구별하기 위해) 아이디>>실제 아이디 값으로 변경-->\r\n            <div v-for=\"(item, idx) in recvList\" :key=\"idx\">\r\n                <div v-if=\"item.userName !== userName\" class=\"other\">{{ item.userName }} : {{ item.content }}</div>\r\n                <!-- {{this.appendText(item.userName, item.connect)}}  추후 테스트-->\r\n                <div v-else class=\"me\">{{ item.content }} </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form\">\r\n            <input class=\"form__input\" id=\"text-data\" type=\"text\" placeholder=\"메세지를 입력하세요.\" v-model=\"message\" @keyup=\"sendMessage\">\r\n           \r\n\r\n              <!-- 보내기 아이콘 비행기 영역 -->\r\n              <svg width=\"30\" height=\"30\" viewBox=\"0 0 68 68\" fill=\"#CCCCCC\">\r\n                <g clip-path=\"url(#clip0_26_10)\">\r\n                  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                    d=\"M48.0833 19.799C48.619 20.3347 48.806 21.127 48.5665 21.8457L35.8385 60.0294C35.5946 60.7614 34.9513 61.2877 34.1855 61.382C33.4198 61.4763 32.6681 61.1217 32.2539 60.4707L22.593 45.2893L7.41158 35.6285C6.76065 35.2142 6.40604 34.4625 6.50031 33.6968C6.59458 32.931 7.12092 32.2878 7.85287 32.0438L46.0366 19.3159C46.7553 19.0763 47.5476 19.2633 48.0833 19.799ZM26.5903 44.1204L33.3726 54.7782L42.0926 28.6181L26.5903 44.1204ZM39.2642 25.7897L23.7619 41.292L13.1041 34.5097L39.2642 25.7897Z\"\r\n                    fill=\"\"/>\r\n                </g>\r\n                <defs>\r\n                  <clipPath id=\"clip0_26_10\">\r\n                    <rect width=\"48\" height=\"48\" fill=\"white\" transform=\"translate(33.9412) rotate(45)\"/>\r\n                  </clipPath>\r\n                </defs>\r\n              </svg>  \r\n          </div>\r\n        </div>\r\n      </td>\r\n    </div>\r\n\r\n  </table>\r\n</div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport Stomp from 'webstomp-client'\r\nimport SockJS from 'sockjs-client'\r\n\r\nexport default {\r\n  name: 'ChatRoom',\r\n  data() {\r\n    return {\r\n      userName: sessionStorage.getItem('user_name'),\r\n      message: \"\",\r\n      recvList: [],\r\n      textData: \"\"\r\n    }\r\n  },\r\n  created() {\r\n    this.connect()\r\n  },\r\n\r\n  props: {\r\n    keyvalue: String\r\n  },\r\n\r\n  methods: {\r\n    sendMessage (e) {\r\n      if(e.keyCode === 13 && this.userName !== '' && this.message !== ''){\r\n        this.send()\r\n        this.message = ''\r\n        \r\n      }\r\n    },    \r\n    send() {\r\n      console.log(\"Send message:\" + this.message);\r\n      if (this.stompClient && this.stompClient.connected) {\r\n        const msg = { \r\n          userName: this.userName,\r\n          content: this.message \r\n        };\r\n        this.stompClient.send(\"/chat_receive/\"+this.keyvalue, JSON.stringify(msg), {});\r\n      }\r\n    },    \r\n    connect() {\r\n      const serverURL = \"http://localhost:8085\"\r\n      let socket = new SockJS(serverURL);\r\n      this.stompClient = Stomp.over(socket);\r\n      console.log(`소켓 연결 시도. 서버 주소: ${serverURL}`)\r\n      this.stompClient.connect(\r\n        {},\r\n        frame => {\r\n          // 소켓 연결 성공\r\n          this.connected = true;\r\n          console.log('소켓 연결 성공', frame);\r\n  \r\n          this.stompClient.subscribe(\"/chat_send/\"+this.keyvalue, res => {\r\n            console.log('메시지 내용.', res.body);\r\n            this.recvList.push(JSON.parse(res.body))\r\n          });\r\n        },\r\n        error => {\r\n          // 소켓 연결 실패\r\n          console.log('소켓 연결 실패', error);\r\n          this.connected = false;\r\n        }\r\n      );        \r\n    },\r\n\r\n    // fnRun() {\r\n    //   let objWSH = new ActiveXObject(\"WScript.Shell\");\r\n    //   objWSH.Run(\"C:/javaram_chat/result.txt\");\r\n    // }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\nh3 {\r\n  margin-right: 0px;\r\n  margin-top: 0px;\r\n  margin-bottom: 0px;\r\n}\r\n\r\ntable tr td {\r\n    padding: 0;\r\n}\r\n\r\n.form {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 1rem;\r\n  background: #ffffff;\r\n  border-radius: 30px 30px 24px 24px;\r\n  /* border: solid aquamarine; */\r\n  box-shadow: 0px -5px 30px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.form__input {\r\n  border: none;\r\n  padding: 0.5rem;\r\n  font-size: 16px;\r\n  width: calc(100% - 60px);\r\n  padding: 5px;\r\n}\r\n\r\n.form__input:focus {\r\n  outline: none;\r\n}\r\n\r\n.form__submit {\r\n  display: flex;\r\n  align-items: center;\r\n  cursor: pointer;\r\n}\r\n\r\nsvg {\r\n  transition: 0.3s;\r\n}\r\n\r\nsvg:hover {\r\n  fill: #999999;\r\n}\r\n\r\n\r\n/* 해당 영역 채팅 배경 */\r\n\r\n/* 메인 */\r\n\r\n.main_left1 {\r\n  margin: auto;\r\n  /* margin-top: 5%;\r\n  margin-bottom: 5%;\r\n  margin-left: 40%; */\r\n  border-radius: 20px;\r\n  background-color: aquamarine;\r\n  text-align: center;\r\n  width: 90%;\r\n  height: 95%;\r\n  font-size: 25px;\r\n  padding: 8px;\r\n}\r\n.main_left2 {\r\n  margin: auto;\r\n  border-radius: 10px;\r\n  background-color: white;\r\n  text-align: left;\r\n  width: 85%;\r\n  height: 90%;\r\n  border: solid aquamarine;\r\n  padding: 15px;\r\n  font-size: 20px;\r\n}\r\n\r\n.main_right {\r\n  margin: auto;\r\n  border-radius: 5px;\r\n  background-color: #f1f1f1;\r\n  text-align: center;\r\n  width: 90%;\r\n  height: 95%;\r\n  padding: 10px;\r\n}\r\n\r\n\r\n/* 채팅 영역 */\r\n.chat_right {\r\n  height: 90%;\r\n  width: 100%;\r\n  overflow-y: auto;\r\n}\r\n\r\n\r\n.table_list {\r\n  width: 500px;\r\n  height: 900px;\r\n}\r\n\r\n.table_chat {\r\n  width: 1200px;\r\n  height: 700px;\r\n}\r\n\r\n\r\n\r\n/* 접속 알림 */\r\n.connect {\r\n  width: 90%;\r\n  margin: auto;\r\n  background-color: aquamarine; /*색깔은 추후에 변경*/\r\n  font-weight: bold; /*글자 굵게*/\r\n  text-align: center;\r\n  margin-top: 10px;\r\n}\r\n\r\n/* 접속 종료 알림 */\r\n.disconnect {\r\n  width: 90%;\r\n  margin: auto;\r\n  background-color: a;\r\n  font-weight: bold; /*글자 굵게*/\r\n  text-align: center;\r\n  margin-top: 10px;\r\n}\r\n\r\n/* 내가 보낸 메시지 */\r\n.me {\r\n  width: 98%;\r\n  margin: 10px;\r\n  background-color: rgb(255, 255, 255);\r\n  text-align: right;\r\n  border-radius: 5px;\r\n  margin-top: 10px;\r\n  margin-right: 5px;\r\n  font-size: 15px;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-right: 10px;\r\n}\r\n\r\n/* 상대방이 보낸 메시지 */\r\n.other {\r\n  width: 98%;\r\n  margin: 10px;\r\n  background-color: #abd1cf;\r\n  text-align: left;\r\n  border-radius: 5px;\r\n  margin-top: 10px;\r\n  margin-left: 5px;\r\n  font-size: 15px;\r\n  padding-top: 8px;\r\n  padding-bottom: 8px;\r\n  padding-left: 10px;\r\n}\r\n\r\n#container{\r\n  margin-left: 150px;\r\n}\r\n\r\n#mail_tab {\r\n    display: flex;\r\n    flex-direction: row;\r\n    flex:1;\r\n    border-left-style: solid;\r\n    border-left-width: 5px;\r\n    border-left-color: #00C9BE;\r\n}\r\n\r\n#mail_title {\r\n    margin-left: 15px;\r\n    /* align-self: center; */\r\n    flex: 6;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}